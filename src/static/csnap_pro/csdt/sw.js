var snapVersion = "7.2.2",
	cacheName = "snap-pwa",
	filesToCache = [
		"snap.html",

		// program
		"../src/morphic.js",
		"../src/symbols.js",
		"../src/widgets.js",
		"../src/blocks.js",
		"../src/threads.js",
		"../src/objects.js",
		"../src/scenes.js",
		"../src/gui.js",
		"../src/paint.js",
		"../src/lists.js",
		"../src/byob.js",
		"../src/tables.js",
		"../src/sketch.js",
		"../src/video.js",
		"../src/maps.js",
		"../src/extensions.js",
		"../src/xml.js",
		"../src/store.js",
		"../src/locale.js",
		"../src/cloud.js",
		"../src/api.js",
		"../src/sha512.js",
		"../src/FileSaver.min.js",
		"./core/blocks.js",
		// "./core/classrooms.js",
		"./core/cloud.js",
		"./core/jquery.min.js",
		"./core/layout.js",
		"./core/misc.js",
		"./core/serializer.js",
		"./core/sprites.js",
		"./core/stage.js",
		"./core/stl.js",
		"./core/tutorials.js",
		"./core/visualizer.js",
		"./core/main.js",
		"./features/nst/lib/bundle.js",

		// translations
		"../locale/lang-ar.js",
		"../locale/lang-bg.js",
		"../locale/lang-bn.js",
		"../locale/lang-ca.js",
		"../locale/lang-ca_VA.js",
		"../locale/lang-cs.js",
		"../locale/lang-de.js",
		"../locale/lang-dk.js",
		"../locale/lang-el.js",
		"../locale/lang-eo.js",
		"../locale/lang-es.js",
		"../locale/lang-et.js",
		"../locale/lang-eu.js",
		"../locale/lang-fi.js",
		"../locale/lang-fr.js",
		"../locale/lang-gl.js",
		"../locale/lang-he.js",
		"../locale/lang-hi.js",
		"../locale/lang-hr.js",
		"../locale/lang-hu.js",
		"../locale/lang-ia.js",
		"../locale/lang-id.js",
		"../locale/lang-it.js",
		"../locale/lang-ja_HIRA.js",
		"../locale/lang-ja.js",
		"../locale/lang-kn.js",
		"../locale/lang-ko.js",
		"../locale/lang-ml.js",
		"../locale/lang-nl.js",
		"../locale/lang-no.js",
		"../locale/lang-pl.js",
		"../locale/lang-pt_BR.js",
		"../locale/lang-pt.js",
		"../locale/lang-ro.js",
		"../locale/lang-ru.js",
		"../locale/lang-si.js",
		"../locale/lang-sk.js",
		"../locale/lang-sv.js",
		"../locale/lang-ta.js",
		"../locale/lang-te.js",
		"../locale/lang-tr.js",
		"../locale/lang-ua.js",
		"../locale/lang-zh_CN.js",
		"../locale/lang-zh_TW.js",

		//libraries
		"libraries/LIBRARIES",

		"libraries/csdt_adinkra.xml",
		"libraries/csdt_beadloom.xml",
		"libraries/csdt_cornrows.xml",
		"libraries/csdt_henna.xml",
		"libraries/csdt_polar.xml",
		"libraries/csdt_rect.xml",
		"libraries/animation_module.xml",
		"libraries/apl.xml",
		"libraries/audioComp_module.xml",
		"libraries/bar-charts.xml",
		"libraries/biginteger.js",
		"libraries/bignumbers.xml",
		"libraries/bignums.js",
		"libraries/bitwise.xml",
		"libraries/bbtSnapExtension.js",
		"libraries/cases.xml",
		"libraries/colors.xml",
		"libraries/Eisenbergification.xml",
		"libraries/frequency_distribution_module.xml",
		"libraries/httpBlocks.xml",
		"libraries/HummingbirdBlocks.xml",
		"libraries/iteration-composition.xml",
		"libraries/leap-library.xml",
		"libraries/list_comprehension_module.xml",
		"libraries/list-utilities.xml",
		"libraries/localstorage_module.xml",
		"libraries/make-variables.xml",
		"libraries/maps_module.xml",
		"libraries/mqttExtension.js",
		"libraries/mqtt.js",
		"libraries/mqtt.xml",
		"libraries/parallel_module.xml",
		"libraries/pixel_module.xml",
		"libraries/schemeNumber.js",
		"libraries/SciSnapExtensions.js",
		"libraries/SciSnap!2Blocks.xml",
		"libraries/serial_module.xml",
		"libraries/signada.js",
		"libraries/signada.xml",
		"libraries/speech_module.xml",
		"libraries/stream-tools.xml",
		"libraries/strings.xml",
		"libraries/textCostumes_module.xml",
		"libraries/try-catch.xml",
		"libraries/variadic-reporters.xml",
		"libraries/word-sentence.xml",

		//costumes
		"Costumes/COSTUMES",

		"Costumes/adinkra-adinkrahene.png",
		"Costumes/adinkra-akokonan.png",
		"Costumes/adinkra-akoma.png",
		"Costumes/adinkra-ananse.png",
		"Costumes/adinkra-asaseyeduru.png",
		"Costumes/adinkra-aya.png",
		"Costumes/adinkra-dwennimmen.png",
		"Costumes/adinkra-epa.png",
		"Costumes/adinkra-funtunfunefu.png",
		"Costumes/adinkra-gyenayme.png",
		"Costumes/adinkra-mmeredane.png",
		"Costumes/adinkra-mpatapo.png",
		"Costumes/adinkra-mpuannum.png",
		"Costumes/adinkra-odonnyewfiekwan.png",
		"Costumes/adinkra-sankofa.png",
		"Costumes/adinkra-sepow.png",
		"Costumes/akofena.png",
		"Costumes/akon.png",
		"Costumes/alicia-garza.png",
		"Costumes/angeladavis.png",
		"Costumes/anishinaabe-berry.png",
		"Costumes/anishinaabe-bigpetal.png",
		"Costumes/anishinaabe-bud1.png",
		"Costumes/anishinaabe-flower1.png",
		"Costumes/anishinaabe-flower2.png",
		"Costumes/anishinaabe-leaf1.png",
		"Costumes/anishinaabe-medicinewheel.png",
		"Costumes/anishinaabe-petal.png",
		"Costumes/anishinaabe-petal2.png",
		"Costumes/anishinaabe-rhombus.png",
		"Costumes/appalachian-blond.png",
		"Costumes/appalachian-green.png",
		"Costumes/appalachian-plaid.png",
		"Costumes/appalachian-rose.png",
		"Costumes/appalachian-white.png",
		"Costumes/barack_obama.png",
		"Costumes/bese.png",
		"Costumes/beyonce-2.png",
		"Costumes/beyonce.png",
		"Costumes/bink.png",
		"Costumes/black-arts-matter.png",
		"Costumes/blackpanther.png",
		"Costumes/boam.png",
		"Costumes/bulldog.png",
		"Costumes/cardiB-2.png",
		"Costumes/cardiB.png",
		"Costumes/cat.png",
		"Costumes/chadwick-boseman.png",
		"Costumes/crown.png",
		"Costumes/dame.png",
		"Costumes/dance1.png",
		"Costumes/dance2.png",
		"Costumes/dance3.png",
		"Costumes/dance4.png",
		"Costumes/denk.png",
		"Costumes/dove.png",
		"Costumes/drake.png",
		"Costumes/duafe.png",
		"Costumes/easyE.png",
		"Costumes/eban.png",
		"Costumes/equality.png",
		"Costumes/esen.png",
		"Costumes/face.png",
		"Costumes/fawo.png",
		"Costumes/fiha.png",
		"Costumes/fofo.png",
		"Costumes/forbiddensign.png",
		"Costumes/fourdirections-head.png",
		"Costumes/fourdirections-human.png",
		"Costumes/fourdirections-kite.png",
		"Costumes/fourdirections-rhombus1.png",
		"Costumes/fourdirections-rhombus2.png",
		"Costumes/fourdirections-triangle1.png",
		"Costumes/fourdirections-triangle2.png",
		"Costumes/fourdirections-turtle_island.png",
		"Costumes/fourdirections-turtlefoot.png",
		"Costumes/fourdirections-turtlehead.png",
		"Costumes/gees-gb_unit1.png",
		"Costumes/gees-gb_unit2.png",
		"Costumes/gees-stripe.png",
		"Costumes/gees-stripes.png",
		"Costumes/gees-stripes3.png",
		"Costumes/george_floyd.png",
		"Costumes/hands-2.png",
		"Costumes/hands.png",
		"Costumes/harriett-tubman.png",
		"Costumes/headphones-2.png",
		"Costumes/headphones.png",
		"Costumes/hwem.png",
		"Costumes/hyena.png",
		"Costumes/hyew.png",
		"Costumes/jayZ.png",
		"Costumes/juicewrld.gif",
		"Costumes/juicewrld.png",
		"Costumes/kamala-harris.png",
		"Costumes/kanye-west.png",
		"Costumes/kendrick-lamar-2.png",
		"Costumes/kendrick-lamar.png",
		"Costumes/ketepa.png",
		"Costumes/kint.png",
		"Costumes/kwat.png",
		"Costumes/lakota-rhombus.png",
		"Costumes/lakota-rhombus1.png",
		"Costumes/lil-wayne.png",
		"Costumes/lilWayne-2.png",
		"Costumes/lion.png",
		"Costumes/mae_jemison.png",
		"Costumes/malcolmx.png",
		"Costumes/martinluther.png",
		"Costumes/mate.png",
		"Costumes/mewarewo.png",
		"Costumes/mfra.png",
		"Costumes/mlk-3.png",
		"Costumes/mlk.png",
		"Costumes/mmus.png",
		"Costumes/moneybag1.png",
		"Costumes/mustang-2.png",
		"Costumes/mustang.png",
		"Costumes/neao.png",
		"Costumes/neaope.png",
		"Costumes/neil-degrasse-tyson.png",
		"Costumes/nicki-minaj-2.png",
		"Costumes/nicki-minaj.png",
		"Costumes/nkon.png",
		"Costumes/nkyi.png",
		"Costumes/nkyimu.png",
		"Costumes/notoriousBIG.png",
		"Costumes/nsaa.png",
		"Costumes/nsor.png",
		"Costumes/nyabi.png",
		"Costumes/nyame-nti.png",
		"Costumes/nyamedua.png",
		"Costumes/nyameohene.png",
		"Costumes/nyan.png",
		"Costumes/nyawu.png",
		"Costumes/okodee.png",
		"Costumes/onyan.png",
		"Costumes/osra.png",
		"Costumes/owof.png",
		"Costumes/owuo-atwedee.png",
		"Costumes/panther-1.png",
		"Costumes/panther-2.png",
		"Costumes/panther-3.png",
		"Costumes/peace-sign.png",
		"Costumes/pemp.png",
		"Costumes/pharrel-2.png",
		"Costumes/pharrel.png",
		"Costumes/political-solidarity.png",
		"Costumes/rihanna.png",
		"Costumes/sesa.png",
		"Costumes/soccer1.png",
		"Costumes/soccer2.png",
		"Costumes/soccer3.png",
		"Costumes/soccer4.png",
		"Costumes/socialjustice-breakTheseChains.png",
		"Costumes/socialjustice-dontShoot.png",
		"Costumes/socialjustice-dove.png",
		"Costumes/socialjustice-dreads2.png",
		"Costumes/socialjustice-fist.png",
		"Costumes/socialjustice-heart.png",
		"Costumes/socialjustice-hipHop.png",
		"Costumes/socialjustice-libertyBell.png",
		"Costumes/socialjustice-micHand.png",
		"Costumes/socialjustice-peace2.png",
		"Costumes/socialjustice-quincunx.png",
		"Costumes/socialjustice-scaleOfJustice.png",
		"Costumes/socialjustice-write.png",
		"Costumes/socialjustice-write2.png",
		"Costumes/sports-motion0.png",
		"Costumes/sports-motion1.png",
		"Costumes/sports-motion2.png",
		"Costumes/sports-motion3.png",
		"Costumes/sports-motion4.png",
		"Costumes/suri.png",
		"Costumes/SZA-2.png",
		"Costumes/SZA.png",
		"Costumes/tamf.png",
		"Costumes/tear.png",
		"Costumes/the-weeknd-2.png",
		"Costumes/the-weeknd.png",
		"Costumes/tiger.png",
		"Costumes/tupac.png",
		"Costumes/unity-hands.png",
		"Costumes/wawa.png",
		"Costumes/wofo.png",
		"Costumes/wonsa.png",

		// Backgrounds
		"Backgrounds/BACKGROUNDS",

		"Backgrounds/xy-grid.gif",

		// Sounds
		"Sounds/SOUNDS",

		"Sounds/ASAP-Rocky-x-Drake.mp3",
		"Sounds/Black Thought.mp3",
		"Sounds/Cardi B.mp3",
		"Sounds/Chris Brown.mp3",
		"Sounds/crow-hop-black-lodge.mp3",
		"Sounds/DaBaby x Roddy Ricch.mp3",
		"Sounds/Dr Dre.mp3",
		"Sounds/Drake x Travis Scott.mp3",
		"Sounds/dreams-wounded-knee.mp3",
		"Sounds/Eminem.mp3",
		"Sounds/Erykah-Badu.mp3",
		"Sounds/grass-dance-song-northern-wind.mp3",
		"Sounds/Isaiah Rashad x J Cole.mp3",
		"Sounds/J Cole x Erykah Badu.mp3",
		"Sounds/Juice Wrld.mp3",
		"Sounds/Kayne West.mp3",
		"Sounds/Kendrick Lamar x J Cole.mp3",
		"Sounds/Logic.mp3",
		"Sounds/Megan Thee Stallion x Nicki Minaj.mp3",
		"Sounds/pay-2-be-poisoned-soufy.mp3",
		"Sounds/pieceful-revolution-tallpaul.mp3",
		"Sounds/Pop Smoke.mp3",
		"Sounds/prayers-in-a-song-tallpaul.mp3",
		"Sounds/raiz-up-disrupt-soufy.mp3",
		"Sounds/Royce Da 5'9 x Eminem.mp3",
		"Sounds/Royce Da 5'9.mp3",
		"Sounds/sneak-up-northern-cree.mp3",
		"Sounds/sneak-up-whoosh-northern-cree.mp3",
		"Sounds/snotty-nose-rez.mp3",
		"Sounds/somewhere-supaman.mp3",
		"Sounds/straight-step-young-spirit.mp3",
		"Sounds/supaman-beats.mp3",
		"Sounds/Travis Scott x Drake.mp3",
		"Sounds/tribe-called-red.mp3",
		"Sounds/XXXTENTACION x Leeder.mp3",

		// Examples
		"Examples/EXAMPLES",

		"Examples/adinkra-animations.xml",
		"Examples/adinkra-carving.xml",
		"Examples/adinkra-stamping.xml",
		"Examples/bead-loom.xml",
		"Examples/cornrow-curves.xml",
		"Examples/darwin-game.xml",
		"Examples/graffiti.xml",
		"Examples/henna-curves.xml",
		"Examples/henna-flowers.xml",
		"Examples/henna-straight.xml",
		"Examples/henna-vines.xml",
		"Examples/quilting-anishinaabe.xml",
		"Examples/quilting-appalachian.xml",
		"Examples/quilting-fourdirections.xml",
		"Examples/quilting-geesbend.xml",
		"Examples/quilting-lakota.xml",
		"Examples/scifi-bailey.xml",
		"Examples/scifi-biggers.xml",
		"Examples/scifi-nontsi.xml",
		"Examples/scifi-saya.xml",
		"Examples/yarnart-polar.xml",
		"Examples/yarnart-rect.xml",
	];

/* Start the service worker and cache all of the app's content */
self.addEventListener("install", function (e) {
	e.waitUntil(
		caches.open(cacheName).then(function (cache) {
			return cache.addAll(filesToCache);
		})
	);
});

self.addEventListener("activate", (evt) => {
	evt.waitUntil(
		caches.keys().then((keyList) => {
			return Promise.all(
				keyList.map((key) => {
					if (key !== cacheName) {
						return caches.delete(key);
					}
				})
			);
		})
	);
	self.clients.claim();
});

/* Serve cached content when offline */
self.addEventListener("fetch", function (e) {
	e.respondWith(
		caches.match(e.request, { ignoreSearch: true }).then(function (response) {
			return response || fetch(e.request);
		})
	);
});
